{% extends 'nflpix/base.html' %}

{% block content %}
<h1>NFL Schedule - This Week</h1>

<form method="POST" action="{% url 'display_nfl_schedule' %}">
  {% csrf_token %}
  <table>
    <thead>
      <tr>
        <th>Date</th>
        <th>Matchup</th>
        <th>Start Time</th>
        <th>Your Pick</th>
      </tr>
    </thead>
    <tbody>
      {% for item in games_with_info %}
        {% with game=item.game %}
          <tr>
            <td>{{ game.date }}</td>
            <td>{{ game.away_team }} @ {{ game.home_team }}</td>
            <td>{{ game.start_time }}</td>
            <td>
              {% if item.started %}
                <em>Picks closed</em><br />
                Your pick: <strong>{{ item.user_pick|default:"None" }}</strong>
              {% else %}
                <label>
                  <input type="radio" name="pick_{{ game.id }}" value="away"
                    {% if item.user_pick == 'away' %}checked{% endif %} />
                  {{ game.away_team }}
                </label>
                <label>
                  <input type="radio" name="pick_{{ game.id }}" value="home"
                    {% if item.user_pick == 'home' %}checked{% endif %} />
                  {{ game.home_team }}
                </label>
              {% endif %}
            </td>
          </tr>
        {% endwith %}
      {% empty %}
        <tr><td colspan="4">No games found for this week.</td></tr>
      {% endfor %}
    </tbody>
  </table>

  <button type="submit">Save Picks</button>
</form>

{% if messages %}
  <ul class="messages">
    {% for message in messages %}
      <li class="{{ message.tags }}">{{ message }}</li>
    {% endfor %}
  </ul>
{% endif %}

{% endblock %}
